@model isriding.Web.Models.School.BikesiteModel
@{
    ViewBag.Title = "桩点管理";
}

@Html.Partial("_Search", Model.Search)
@Html.Partial("_List")

@Html.Partial("Modal")

@section scripts{
    <script>
        var oTable = null;

        $(function() {
            var actionUrl = "@Url.Action("InitDataTable")?rand=" + Math.random();
            var aoColumns = [
                { "sName": "sort" },
                { "sName": "name" },
                { "sName": "school_name" },
                {
                    "sName": "type",
                    "fnRender": function (oObj) {
                        var render;
                        var t = oObj.aData[3];
                        if (t === "1") {
                            render = '普通';
                        } else if (t === "2") {
                            render = '防盗';
                        } else {
                            render = '租车';
                        }

                        return render;
                    }
                },
                { "sName": "gps_point" },
                { "sName": "radius" },
                {
                    "sName": "action",
                    "fnRender": function(oObj) {
                        var editUrl = '@Url.Action("Edit")';
                        var deleteUrl = '@Url.Action("Delete")';
                        return TableManaged.btnEdit(editUrl, oObj.aData[oObj.aData.length - 1]) + ' ' + TableManaged.btnDelete(deleteUrl, oObj.aData[oObj.aData.length - 1]);
                    }
                }
            ];

            oTable = TableManaged.init($(".datatable"), actionUrl, aoColumns);

            $('#search_form').keypress(function (e) {
                if (e.which === 13) {
                    e.preventDefault();//取消回车原事件
                    TableManaged.search('@Url.Action("InitDataTable")');
                }
            });
        });

        //新增
        function Create(actionUrl) {
            ShowModal(actionUrl, {}, "新增桩点");
        }

        //编辑
        function Edit(actionUrl, id) {
            var param = { id: id };
            ShowModal(actionUrl, param, "编辑桩点");
        }

        //保存
        function Save() {
            SaveModal(oTable);
        }
    </script>
}